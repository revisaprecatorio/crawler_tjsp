O site TJSP exige AMBOS: certificado digital E login/senha. Vamos verificar se o c√≥digo j√° trata isso e configurar corretamente.

Perfeito! Vejo que o c√≥digo J√Å TRATA AMBOS! Olhe a linha 298-300:

python
if user and pwd and _cas_login_with_password(wait, driver, user, pwd):
    debug(payload, "CAS: login CPF/CNPJ OK."); return
O fluxo √©:

Tenta certificado primeiro (linhas 256-295)
Se falhar, tenta CPF/senha (linha 298)
Vamos ver a fun√ß√£o 
_cas_login_with_password
:

Perfeito! O c√≥digo J√Å EST√Å PRONTO para fazer login com CPF/senha! Vamos configurar:

‚úÖ SOLU√á√ÉO: Configurar CPF/Senha no .env
Na VPS, execute:

bash
# Editar .env
nano /opt/crawler_tjsp/.env
Adicione estas linhas ao final:

bash
# ===== AUTENTICA√á√ÉO CAS (CPF/SENHA) =====
CAS_USUARIO=51764890230
CAS_SENHA=903205
Salvar: Ctrl+O, Enter, Ctrl+X

üîÑ Reiniciar e Testar
bash
# Reiniciar worker
docker compose restart worker

# Resetar 1 job para teste
psql -h 72.60.62.124 -U admin -d n8n -c "UPDATE consultas_esaj SET status = FALSE WHERE id = 28;"

# Monitorar logs
docker compose logs -f worker
üìä O QUE ESPERAR NOS LOGS:
Sucesso:
[INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
[INFO] ‚úÖ Conectado ao Selenium Grid com sucesso!
CAS: tentando aba CERTIFICADO‚Ä¶
CAS: falha no certificado. Tentando CPF/CNPJ‚Ä¶
CAS: login CPF/CNPJ OK.
Se der erro:
CAS: autentica√ß√£o necess√°ria e n√£o realizada.
‚Üí CPF/senha incorretos ou formato errado

üéØ FORMATO DO CPF
O c√≥digo aceita CPF com ou sem formata√ß√£o:

51764890230 ‚úÖ (sem pontos/tra√ßos)
517.648.902-30 ‚úÖ (com formata√ß√£o)
Vamos usar sem formata√ß√£o para garantir: 51764890230

Execute os comandos acima e me envie os logs! üöÄ

--- EXEC ---

root@srv987902:/opt/crawler_tjsp# nano /opt/crawler_tjsp/.env
root@srv987902:/opt/crawler_tjsp# psql -h 72.60.62.124 -U admin -d n8n -c "UPDATE consultas_esaj SET status = FALSE WHERE id = 28;"
Password for user admin: 
UPDATE 1
root@srv987902:/opt/crawler_tjsp# docker compose restart worker
WARN[0000] /opt/crawler_tjsp/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
[+] Restarting 1/1
 ‚úî Container tjsp_worker_1  Started                                              0.2s 
root@srv987902:/opt/crawler_tjsp# docker compose logs -f worker
WARN[0000] /opt/crawler_tjsp/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Item encontrado para processar: ID=28, CPF=06495530803
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 1/3 do Job ID=28: Processo 0223266-55.2021.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0223266-55.2021.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ‚úÖ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0223266-55.2021.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autentica√ß√£o necess√°ria e n√£o realizada.\")\nRuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 19:49:36",
tjsp_worker_1  |   "finished_at": "2025-10-01 19:49:44",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0223266_55_2021_8_26_0500_20251001_194944.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0223266_55_2021_8_26_0500_20251001_194944.png",
tjsp_worker_1  |   "duration_seconds": 7.33,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 2/3 do Job ID=28: Processo 0179487-50.2021.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0179487-50.2021.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ‚úÖ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0179487-50.2021.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autentica√ß√£o necess√°ria e n√£o realizada.\")\nRuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 19:49:44",
tjsp_worker_1  |   "finished_at": "2025-10-01 19:49:51",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0179487_50_2021_8_26_0500_20251001_194950.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0179487_50_2021_8_26_0500_20251001_194950.png",
tjsp_worker_1  |   "duration_seconds": 6.67,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 3/3 do Job ID=28: Processo 7007473-24.2010.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 7007473-24.2010.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ‚úÖ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "7007473-24.2010.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autentica√ß√£o necess√°ria e n√£o realizada.\")\nRuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 19:49:51",
tjsp_worker_1  |   "finished_at": "2025-10-01 19:49:58",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_7007473_24_2010_8_26_0500_20251001_194957.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_7007473_24_2010_8_26_0500_20251001_194957.png",
tjsp_worker_1  |   "duration_seconds": 6.658,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | Atualizando status para 'processado = TRUE' para o ID: 28
tjsp_worker_1  | [SUCESSO] Status atualizado para o ID 28.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Item encontrado para processar: ID=28, CPF=06495530803
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 1/3 do Job ID=28: Processo 0223266-55.2021.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0223266-55.2021.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ‚úÖ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0223266-55.2021.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autentica√ß√£o necess√°ria e n√£o realizada.\")\nRuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 20:03:25",
tjsp_worker_1  |   "finished_at": "2025-10-01 20:03:32",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0223266_55_2021_8_26_0500_20251001_200332.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0223266_55_2021_8_26_0500_20251001_200332.png",
tjsp_worker_1  |   "duration_seconds": 6.978,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 2/3 do Job ID=28: Processo 0179487-50.2021.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0179487-50.2021.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ‚úÖ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0179487-50.2021.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autentica√ß√£o necess√°ria e n√£o realizada.\")\nRuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 20:03:32",
tjsp_worker_1  |   "finished_at": "2025-10-01 20:03:39",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0179487_50_2021_8_26_0500_20251001_200339.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0179487_50_2021_8_26_0500_20251001_200339.png",
tjsp_worker_1  |   "duration_seconds": 6.737,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 3/3 do Job ID=28: Processo 7007473-24.2010.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 7007473-24.2010.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ‚úÖ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "7007473-24.2010.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autentica√ß√£o necess√°ria e n√£o realizada.\")\nRuntimeError: CAS: autentica√ß√£o necess√°ria e n√£o realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 20:03:39",
tjsp_worker_1  |   "finished_at": "2025-10-01 20:03:46",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_7007473_24_2010_8_26_0500_20251001_200346.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_7007473_24_2010_8_26_0500_20251001_200346.png",
tjsp_worker_1  |   "duration_seconds": 6.673,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | Atualizando status para 'processado = TRUE' para o ID: 28
tjsp_worker_1  | [SUCESSO] Status atualizado para o ID 28.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o pr√≥ximo item da fila...
tjsp_worker_1  | Conex√£o com o banco de dados fechada.
tjsp_worker_1  | Nenhum precat√≥rio novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0

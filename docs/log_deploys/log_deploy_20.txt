root@srv987902:/opt/crawler_tjsp# psql -h 72.60.62.124 -U admin -d n8n -c "
UPDATE consultas_esaj 
SET status = FALSE 
WHERE id IN (
    SELECT id FROM consultas_esaj 
    WHERE status = TRUE 
    ORDER BY id DESC 
    LIMIT 5
);"
Password for user admin: 
UPDATE 5
root@srv987902:/opt/crawler_tjsp# psql -h 72.60.62.124 -U admin -d n8n -c "
SELECT COUNT(*) as pendentes 
FROM consultas_esaj 
WHERE status = FALSE OR status IS NULL;"
Password for user admin: 
 pendentes 
-----------
         5
(1 row)

root@srv987902:/opt/crawler_tjsp# docker compose up -d
WARN[0000] /opt/crawler_tjsp/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
[+] Running 2/2
 ✔ Container selenium_chrome  Running                                            0.0s 
 ✔ Container tjsp_worker_1    Started                                            0.0s 
root@srv987902:/opt/crawler_tjsp# docker compose ps
WARN[0000] /opt/crawler_tjsp/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
NAME              IMAGE                               COMMAND                  SERVICE           CREATED         STATUS                          PORTS
selenium_chrome   selenium/standalone-chrome:latest   "/opt/bin/entry_poin…"   selenium-chrome   9 minutes ago   Up 9 minutes                    0.0.0.0:4444->4444/tcp, [::]:4444->4444/tcp, 5900/tcp, 0.0.0.0:7900->7900/tcp, [::]:7900->7900/tcp, 9000/tcp
tjsp_worker_1     tjsp-worker:latest                  "python orchestrator…"   worker            9 minutes ago   Restarting (0) 45 seconds ago   
root@srv987902:/opt/crawler_tjsp# docker compose logs -f worker
WARN[0000] /opt/crawler_tjsp/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion 
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Item encontrado para processar: ID=28, CPF=06495530803
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 1/3 do Job ID=28: Processo 0223266-55.2021.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0223266-55.2021.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0223266-55.2021.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:55:41",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:55:51",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0223266_55_2021_8_26_0500_20251001_185551.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0223266_55_2021_8_26_0500_20251001_185551.png",
tjsp_worker_1  |   "duration_seconds": 10.013,
tjsp_worker_1  |   "duration_hms": "0m10s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 2/3 do Job ID=28: Processo 0179487-50.2021.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0179487-50.2021.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0179487-50.2021.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:55:51",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:55:58",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0179487_50_2021_8_26_0500_20251001_185558.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0179487_50_2021_8_26_0500_20251001_185558.png",
tjsp_worker_1  |   "duration_seconds": 6.905,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 3/3 do Job ID=28: Processo 7007473-24.2010.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 7007473-24.2010.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/06495530803
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "7007473-24.2010.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:55:58",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:56:06",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_7007473_24_2010_8_26_0500_20251001_185606.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_7007473_24_2010_8_26_0500_20251001_185606.png",
tjsp_worker_1  |   "duration_seconds": 7.222,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | Atualizando status para 'processado = TRUE' para o ID: 28
tjsp_worker_1  | [SUCESSO] Status atualizado para o ID 28.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Item encontrado para processar: ID=29, CPF=27308157830
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 1/2 do Job ID=29: Processo 0158003-37.2025.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0158003-37.2025.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/27308157830
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0158003-37.2025.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:56:06",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:56:13",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0158003_37_2025_8_26_0500_20251001_185613.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0158003_37_2025_8_26_0500_20251001_185613.png",
tjsp_worker_1  |   "duration_seconds": 6.994,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 2/2 do Job ID=29: Processo 0015796-15.2025.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0015796-15.2025.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/27308157830
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0015796-15.2025.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:56:13",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:56:20",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0015796_15_2025_8_26_0500_20251001_185620.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0015796_15_2025_8_26_0500_20251001_185620.png",
tjsp_worker_1  |   "duration_seconds": 6.949,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | Atualizando status para 'processado = TRUE' para o ID: 29
tjsp_worker_1  | [SUCESSO] Status atualizado para o ID 29.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Item encontrado para processar: ID=30, CPF=07620857893
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 1/1 do Job ID=30: Processo 0077044-50.2023.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0077044-50.2023.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/07620857893
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0077044-50.2023.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:56:21",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:56:27",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0077044_50_2023_8_26_0500_20251001_185627.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0077044_50_2023_8_26_0500_20251001_185627.png",
tjsp_worker_1  |   "duration_seconds": 6.811,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | Atualizando status para 'processado = TRUE' para o ID: 30
tjsp_worker_1  | [SUCESSO] Status atualizado para o ID 30.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Item encontrado para processar: ID=31, CPF=07620857893
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 1/1 do Job ID=31: Processo 0077044-50.2023.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0077044-50.2023.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/07620857893
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0077044-50.2023.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:56:28",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:56:35",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0077044_50_2023_8_26_0500_20251001_185635.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0077044_50_2023_8_26_0500_20251001_185635.png",
tjsp_worker_1  |   "duration_seconds": 6.84,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | Atualizando status para 'processado = TRUE' para o ID: 31
tjsp_worker_1  | [SUCESSO] Status atualizado para o ID 31.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Item encontrado para processar: ID=32, CPF=07620857893
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | 
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Processando item 1/1 do Job ID=32: Processo 0077044-50.2023.8.26.0500
tjsp_worker_1  | ================================================================================
tjsp_worker_1  | Executando comando: /usr/local/bin/python crawler_full.py --doc 0077044-50.2023.8.26.0500 --abrir-autos --baixar-pdf --turbo-download --download-dir /app/downloads/07620857893
tjsp_worker_1  | 
tjsp_worker_1  | --- Output do Crawler ---
tjsp_worker_1  | [INFO] Conectando ao Selenium Grid: http://selenium-chrome:4444
tjsp_worker_1  | [INFO] ✅ Conectado ao Selenium Grid com sucesso!
tjsp_worker_1  | {
tjsp_worker_1  |   "documento": null,
tjsp_worker_1  |   "processo": "0077044-50.2023.8.26.0500",
tjsp_worker_1  |   "ok": false,
tjsp_worker_1  |   "has_precatorio": false,
tjsp_worker_1  |   "found_process_numbers": [],
tjsp_worker_1  |   "results": [],
tjsp_worker_1  |   "error": "RuntimeError: CAS: autenticação necessária e não realizada.\nTraceback (most recent call last):\n  File \"/app/crawler_full.py\", line 1268, in go_and_extract\n    _maybe_cas_login(wait, driver, cert_subject_cn, user=cas_usuario, pwd=cas_senha, payload=payload)\n  File \"/app/crawler_full.py\", line 300, in _maybe_cas_login\n    raise RuntimeError(\"CAS: autenticação necessária e não realizada.\")\nRuntimeError: CAS: autenticação necessária e não realizada.\n",
tjsp_worker_1  |   "downloaded_files": [],
tjsp_worker_1  |   "started_at": "2025-10-01 18:56:35",
tjsp_worker_1  |   "finished_at": "2025-10-01 18:56:42",
tjsp_worker_1  |   "last_url": "https://esaj.tjsp.jus.br/sajcas/login?service=https%3A%2F%2Fesaj.tjsp.jus.br%2Fcpopg%2Fj_spring_cas_security_check",
tjsp_worker_1  |   "error_html_path": "screenshots/erro_0077044_50_2023_8_26_0500_20251001_185642.html",
tjsp_worker_1  |   "error_screenshot_path": "screenshots/erro_0077044_50_2023_8_26_0500_20251001_185642.png",
tjsp_worker_1  |   "duration_seconds": 6.744,
tjsp_worker_1  |   "duration_hms": "0m07s"
tjsp_worker_1  | }
tjsp_worker_1  | 
tjsp_worker_1  | --- Fim do Output ---
tjsp_worker_1  | 
tjsp_worker_1  | 
tjsp_worker_1  | Atualizando status para 'processado = TRUE' para o ID: 32
tjsp_worker_1  | [SUCESSO] Status atualizado para o ID 32.
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com obanco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
tjsp_worker_1  | Conectando ao banco de dados PostgreSQL...
tjsp_worker_1  | Executando a query para buscar o próximo item da fila...
tjsp_worker_1  | Conexão com o banco de dados fechada.
tjsp_worker_1  | Nenhum precatório novo para processar encontrado. Encerrando o worker.
tjsp_worker_1 exited with code 0
